package tv.superawesome  {	import flash.display.Stage;	import flash.geom.Rectangle;	import flash.media.StageWebView;	import flash.events.*;	import flash.net.*;	import flash.system.Capabilities;		public class VideoAd extends EventDispatcher{		private var webView:StageWebView;		public function VideoAd(stage:Stage, viewPort:Rectangle, appId:Number, placementId:Number)		{			// constructor code			this.webView = new StageWebView();			this.webView.stage = stage;			this.webView.viewPort = viewPort;			this.webView.addEventListener(Event.COMPLETE, onComplete);			this.webView.addEventListener(ErrorEvent.ERROR, onError);			this.webView.loadURL("http://ads.superawesome.tv/v1/air/preroll?app_id="+appId+"&placement_id="+placementId);		}		private function onLocationChanging(event:LocationChangeEvent):void		{			var arr:Array = event.location.split("?");			if(arr.length > 1){				var vars:URLVariables = new URLVariables(arr[1]);				var eventName:String = vars.event;				if(eventName != null){					if(eventName == "finished"){						webView.stage = null;						webView.dispose();						event.preventDefault();						dispatchEvent(new Event(Event.COMPLETE));						return;					}else if(eventName == "error"){						webView.stage = null;						webView.dispose();						event.preventDefault();						dispatchEvent(new ErrorEvent(ErrorEvent.ERROR));						return;											}				}			}			event.preventDefault();			var request:URLRequest = new URLRequest(event.location);			flash.net.navigateToURL(request)		}		private function onComplete(e:Event):void        {            this.webView.addEventListener(LocationChangeEvent.LOCATION_CHANGING, onLocationChanging);        }        private function onError(e:ErrorEvent):void        {        	dispatchEvent(new ErrorEvent(ErrorEvent.ERROR));        }	}	}